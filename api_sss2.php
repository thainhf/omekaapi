<?php//get content จากข้อมูลเว็บ link ภายนอก//include_once('inc_get_remote_data.php');?><?phpecho "<br>===================";echo "<br>คลังข้อมูลดิจิทัล ชุด 2";$psru_q="การผลิต";$psru_per_page="&page=1&per_page=16";//$psru_api_url= "http://202.29.80.66/onesearch/api/items?search=".$psru_q.$psru_per_page;//$psru_api_url="http://ec2-18-139-29-204.ap-southeast-1.compute.amazonaws.com/api/items?item_set_id=15&page=1&per_page=50";$psru_api_url="http://ec2-18-139-29-204.ap-southeast-1.compute.amazonaws.com/api/media?page=1&per_page=50";$curl = curl_init($psru_api_url);curl_setopt($curl, CURLOPT_URL, $psru_api_url);curl_setopt($curl, CURLOPT_RETURNTRANSFER, true);$headers = array(    "REST-API-Key: 1111",);curl_setopt($curl, CURLOPT_HTTPHEADER, $headers);//for debug only!curl_setopt($curl, CURLOPT_SSL_VERIFYHOST, false);curl_setopt($curl, CURLOPT_SSL_VERIFYPEER, false);$resp = curl_exec($curl);curl_close($curl);//var_dump($resp);$words_f = ["o:", "dcterms:", ":tag", "o-module-folksonomy", "@value", "@id"];$words_r   = ["o_", "dcterms_", "_tag", "o_module_folksonomy", "a_value", "_id"];$resp = str_replace($words_f,$words_r,$resp);//$resp = str_replace("o:","o-",$resp);$json_objekat    = json_decode($resp);//echo "<hr>";//echo $psru_api_url."<br>";$data=[];$myArray= array();$psruCollecArray= array();if(!empty($json_objekat)) {foreach ($json_objekat as $objQuote) {    $object = new stdClass();    $object->id = "";    $object->title = "";    $object->subject = "";    $object->description = "";    $object->tag = "";    $object->abstract = "";    $object->filename = "";    $object->fileurl = "";    $object->original_url = ""; //original file    $object->content = "";    $object->label_class = "";    $object->datetime = ""; //วันที่บันทึกข้อมูล    $object->type = ""; //ประเภท    $object->date = ""; //ปีที่ผลิตเอกสาร//    echo "<pre>999=";//    print_r($objQuote);//    echo "</pre>";//    echo "<hr>";   /// $objj1= $objQuote[1];    $o_id=$objQuote->o_id;    $object->id = $o_id;//ชื่อเรื่องหนังสือ    $o_title=$objQuote->o_title;    $object->title = $o_title;    //ชื่อไฟล์    $o_source=$objQuote->o_source;    $object->filename = $o_source;    $o_original_url=$objQuote->o_original_url;    $object->original_url = $o_original_url;    //Date time    $o_created=$objQuote->o_created;   // echo "<pre>Date=";   //  print_r($o_created);   // echo "</pre>";  //  echo "<hr>";    $object->datetime = $o_created->a_value;  // print_r($objj1); //  echo "ชื่อเรื่องหนังสือ=".$o_title; //   echo "<br>";   // หัวเรื่อง dcterms:subject    /*    if(isset($objQuote->dcterms_subject)){        $subject_arr=$objQuote->dcterms_subject;        if(!empty($subject_arr)){            $vsubject="";            foreach ($subject_arr as $subject) {                $vsubject=$vsubject.$subject->a_value.",";            }         //   echo "หัวเรื่อง=".$vsubject;         //   echo "<br>";            $object->subject =$vsubject;        }    }*/    // print_r($objj1);    //description    // print_r($objj1);    /*    if(isset($objQuote->dcterms_description)){        $description_arr=$objQuote->dcterms_description;        if(!empty($description_arr)){            $vdescription="";            foreach ($description_arr as $description) {                $vdescription=$vdescription.$description->a_value;            }            $object->description = $vdescription;          //  echo "description=".$vdescription;          //  echo "<br>";        }    }    */    //tag    /*    if(isset($objQuote->o_module_folksonomy_tag)){        $tag_arr=$objQuote->o_module_folksonomy_tag;        if(!empty($tag_arr)){            $vtag="";            foreach ($tag_arr as $tag) {                $vtag=$vtag.$tag->o_id.",";            }            $object->tag = $vtag;          //  echo "tag=".$vtag;          //  echo "<br>";        }    }*/    //abstract/*    if(isset($objQuote->dcterms_abstract)){        $abstract_arr=$objQuote->dcterms_abstract;        if(!empty($abstract_arr)){            //  $vtag="";            foreach ($abstract_arr as $abstract) {                // echo "tag=".$tag->o_id;                $abstract_value=$abstract->a_value.",";           //     echo "abstract=".$abstract_value;            //    echo "<br>";            }            //  echo "tag=".$vtag;            // echo "<br>";            $object->abstract = $abstract_value;        }    }*///============ชุด 2=====================    //part รูป    if(isset($objQuote->thumbnail_display_urls)){        $thumbnail_arr=$objQuote->thumbnail_display_urls;        if(!empty($thumbnail_arr)){            //  $vtag="";          //  foreach ($thumbnail_arr as $thumbnail) {                // echo "tag=".$tag->o_id;                $thumbnail_url=$thumbnail_arr->large;                //     echo "abstract=".$abstract_value;                //    echo "<br>";          //  }            //  echo "tag=".$vtag;            // echo "<br>";            $object->fileurl = $thumbnail_url;        }    }    //id item รายละเอียด    // Label / Class    $o_item=$objQuote->o_item;    if(isset($o_item)){        $id_item_url = $o_item->_id;        $curl3 = curl_init($id_item_url);        curl_setopt($curl3, CURLOPT_URL, $id_item_url);        curl_setopt($curl3, CURLOPT_RETURNTRANSFER, true);        curl_setopt($curl3, CURLOPT_HTTPHEADER, $headers);//for debug only!        curl_setopt($curl3, CURLOPT_SSL_VERIFYHOST, false);        curl_setopt($curl3, CURLOPT_SSL_VERIFYPEER, false);        $resp3 = curl_exec($curl3);        curl_close($curl3);        $resp3 = str_replace($words_f,$words_r,$resp3);        $json_objekat3    = json_decode($resp3);        if(!empty($json_objekat3)) {//            echo "<pre>json_objekat3=";//            print_r($json_objekat3);//            echo "</pre>";//            echo "<hr>";            if(isset($json_objekat3->o_title)) {                $object->title = $json_objekat3->o_title;            }            // ประเภท Type (บทความ speech academic)                if(!empty($json_objekat3->dcterms_type)) {                    foreach ($json_objekat3->dcterms_type as $dcterms_type_item) {                        $type_label = $dcterms_type_item->a_value;                    }                    $object->type = $type_label;                }                //คำอธิบายรายละเอียดของเอกสาร                if(!empty($json_objekat3->dcterms_description)) {                    foreach ($json_objekat3->dcterms_description as $dcterms_description_item) {                        $description = $dcterms_description_item->a_value;                    }                    $object->description = $description;                }            //ปีที่ผลิตเอกสาร            if(!empty($json_objekat3->dcterms_date)) {                foreach ($json_objekat3->dcterms_date as $dcterms_date_item) {                    $dcterms_date = $dcterms_date_item->a_value;                }                $object->date = $dcterms_date;            }            //id resource class หา ที่มา classes            // Label / Class             if(isset($json_objekat3->o_resource_class)) {                $o_resource_class=$json_objekat3->o_resource_class;                $id_class_url = $o_resource_class->_id;                $curl2 = curl_init($id_class_url);                curl_setopt($curl2, CURLOPT_URL, $id_class_url);                curl_setopt($curl2, CURLOPT_RETURNTRANSFER, true);                curl_setopt($curl2, CURLOPT_HTTPHEADER, $headers);//for debug only!                curl_setopt($curl2, CURLOPT_SSL_VERIFYHOST, false);                curl_setopt($curl2, CURLOPT_SSL_VERIFYPEER, false);                $resp2 = curl_exec($curl2);                curl_close($curl2);                $resp2 = str_replace($words_f,$words_r,$resp2);                $json_objekat2    = json_decode($resp2);                if(!empty($json_objekat2)) {                    //  foreach ($json_objekat2 as $objQuote2) {                  //  echo "<pre>json_objekat2=";                  //  print_r($json_objekat2);                  //  echo "</pre>";                 //   echo "<hr>";                    //  }                    $object->label_class = $json_objekat2->o_label;                }            }          //  $object->label_class = $json_objekat3->o_label;        }    }    //==============================    array_push($psruCollecArray, $object);}}//echo "<pre>psruCollecArray=";//print_r($psruCollecArray);//echo "</pre>========";//echo "<pre>";//print_r($json_objekat);//echo "</pre>";$i=0;//===============================================echo "<table style='border-collapse: collapse;border: 1px solid black;'>  <tr>    <th>ลำดับ</th>    <th>ID</th>    <th>หัวเรื่อง</th>    <th>filename</th>    <th>fileurl</th>     <th>Label / Class</th>     <th>datetime</th>      <th>ปีที่ผลิตเอกสาร</th>     <th>Type</th>     <th>Description</th>  </tr>";  foreach ($psruCollecArray as $item) {      $i=$i+1;      echo "<tr><td width='10'>".$i.".</td><td width='50'>".$item->id."</td><td width='500'>".$item->title."</td><td width='300'>".$item->filename."</td><td width='400'>".$item->fileurl."<br>".$item->original_url."</td><td width='200'>".$item->label_class."</td><td width='300'>".$item->datetime."</td><td width='300'>".$item->date."</td><td width='300'>".$item->type."</td><td width='600'>".$item->description."</td></tr>";  }echo "</table>";?><style>table, th, td {  border: 1px solid black;  border-collapse: collapse;}</style><?php//======================================/*echo "<br>===================";echo "<br>มาหาวิทยาลัยราชภัฏกำแพงเพชร";$kpru_q="วัดบ่อ";$kpru_per_page="&page=1&per_page=16";$kpru_api_url= "https://arit.kpru.ac.th/ap2/local/api.php?nu=qItems&q=".$kpru_q."&Token=S2FtcGhhZW5nIFBoZXQgUmFqYWJoYXQgVW5pdmVyc2l0eQ==";$curl = curl_init($kpru_api_url);curl_setopt($curl, CURLOPT_URL, $kpru_api_url);curl_setopt($curl, CURLOPT_RETURNTRANSFER, true);$headers = array(    "Token: S2FtcGhhZW5nIFBoZXQgUmFqYWJoYXQgVW5pdmVyc2l0eQ==",);curl_setopt($curl, CURLOPT_HTTPHEADER, $headers);//for debug only!curl_setopt($curl, CURLOPT_SSL_VERIFYHOST, false);curl_setopt($curl, CURLOPT_SSL_VERIFYPEER, false);$resp = curl_exec($curl);curl_close($curl);//var_dump($resp);//random array//var_dump($resp);$json_objekat    = json_decode($resp);echo "<hr>";echo $kpru_api_url."<br>";//echo "<pre>";//print_r($json_objekat);//echo "</pre>";$kpruCollecArray= array();$item_show_main=3; //กำหนดแสดง จำนวนรายการต่อ collection//$link="https://arit.kpru.ac.th/ap2/local/?nu=pages&page_id=2179&code_db=610009&code_type=01";$link="https://arit.kpru.ac.th/ap2/local/?nu=pages&page_id=";foreach($json_objekat as $objQuote) {    echo "<pre>kpruCollecArray=";    print_r($objQuote);    echo "</pre>========";    $object = new stdClass();    $object->id =$objQuote->id;    $object->title =$objQuote->title;    $object->subject= $objQuote->info;    $object->date =$objQuote->date_time;    $object->publisher =$objQuote->org;    $object->creator ="";    $object->link =$link.$objQuote->id."&code_db=".$objQuote->code_db."&code_type=".$objQuote->code_type;    $object->images =$objQuote->images;     array_push($kpruCollecArray, $object);}echo "<pre>kpruCollecArray=";print_r($kpruCollecArray);echo "</pre>========";*/?>